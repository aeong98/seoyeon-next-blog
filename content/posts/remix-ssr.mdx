---
title: Remixì˜ SSR, React 18 renderToPipeableStreamì„ ìœ„ì£¼ë¡œ ì‚´í´ë³´ê¸°
description: Remix í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ë©´ì„œ entry.server.tsx íŒŒì¼ì— ìˆëŠ” renderToPipeableStreamë¥¼ ë°œê²¬í–ˆë‹¤. ì–´ë–¤ ì—­í• ì„ í•˜ëŠ” í•¨ìˆ˜ì¸ì§€ ì•Œì•„ë³´ì ğŸ’ª
date: "2025-02-02"
imageUrl: /ssr/ssr-blog-image-3.png
---

ì£¼ë§ì— React ê³µì‹ ë¬¸ì„œë¥¼ ë³¼ì¼ì´ ìˆì–´ì„œ ë‘˜ëŸ¬ë³´ë‹¤ê°€ Introduction ë¶€ë¶„ ì¦ˆìŒì—ì„œ SSR í”„ë ˆì„ì›Œí¬ë¡œ Remixë¥¼ ì¶”ì²œí•˜ëŠ” ë¬¸ì¥ì„ ë°œê²¬í–ˆë‹¤. í‰ì†Œì— í•œë²ˆ ì‚¬ìš©í•´ ë´ì•¼ê² ë‹¤ê³  ìƒê°í•˜ê³  ìˆë˜ í”„ë ˆì„ì›Œí¬ë¼ Remix í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•´ë´¤ê³ , í‰ì†Œ Next.js ë§Œì„ ì‚¬ìš©í•´ì™”ë˜ ë‚´ê²Œ ìƒì†Œí•œ `entry.server.tsx`, `entry.client.tsx` íŒŒì¼ì„ ë³´ê²Œ ë˜ì—ˆë‹¤.

entry.server.tsx ì¦‰, ì„œë²„ì—ì„œ ì‹¤í–‰ë˜ëŠ” íŒŒì¼ì˜ handleBrowserRequestë¼ëŠ” í•¨ìˆ˜ê°€ ëˆˆì— ë“¤ì–´ì™”ë‹¤. (Remix v2.15.3 ê¸°ì¤€)

<Image src={'/ssr/ssr-blog-image-1.png'} alt={'remix-ssr-image-1'} />

Server-sideì—ì„œ HTMLì„ ìƒì„±í•˜ê²Œ ìŠ¤íŠ¸ë¦¬ë° HTTP ì‘ë‹µì„ ë³´ë‚´ëŠ” í•¨ìˆ˜ì¸ ê²ƒ ê°™ì•˜ë‹¤.

ìƒê°ë³´ë‹¤ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„ì´ ë˜ì–´ ìˆë‹¨ ìƒê°ì´ ë“¤ì—ˆë‹¤ ğŸ§

> Next.jsê°€ SSRìª½ ë¡œì§ì´ ë§ì´ ì¶”ìƒí™” ë˜ì–´ìˆê³ , ë˜ ìµœê·¼ì— ë³µì¡ë„ê°€ ë†’ì•„ì§€ê³  ìˆì–´ì„œ í”¼ë¡œê°ì„ ëŠë¼ë˜ ì™€ì¤‘ì— ë¹„êµì  ìµìˆ™í•˜ê±°ë‚˜, ë“¤ì–´ë³¸ì ì´ ìˆëŠ” í•¨ìˆ˜(react ì—ì„œ importëœ..)ë“¤ë¡œ ê°„ë‹¨í•˜ê²Œ êµ¬ì„±ëœ SSR ë¡œì§ì„ ë³´ë‹ˆê¹ í¥ë¯¸ê°€ ìƒê²¼ë‹¤.
>

ì‚¬ì‹¤ SSRì—ì„œ Remixê°€ ë‹´ë‹¹í•˜ê³  ìˆëŠ” ë¶€ë¶„ì€ `RemixServer` ë¼ëŠ” ì»´í¬ë„ŒíŠ¸ ë°–ì— ì—†ì—ˆë‹¤. [ì†ŒìŠ¤ì½”ë“œ](https://github.com/remix-run/remix/blob/main/packages/remix-react/server.tsx)ë¥¼ ì‚´í´ë³´ë‹ˆ, ì„œë²„ì¸¡ HTML ë Œë”ë§ì„ ìœ„í•´ ë°ì´í„°, ë¼ìš°íŒ…, ìŠ¤íŠ¸ë¦¬ë° ê´€ë ¨ ì„¤ì •ì„ ë‹´ë‹¹í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì¸ ê²ƒ ê°™ì•˜ë‹¤. RemixServer ì»´í¬ë„ŒíŠ¸ì˜ ë‚´ë¶€ êµ¬í˜„ê¹Œì§€ ì •ë¦¬í•˜ë©´, ê¸€ì´ ë„ˆë¬´ ê¸¸ì–´ì§ˆ ê²ƒ ê°™ì•„ì„œ ë‚˜ì¤‘ì—(?) í•´ë³´ê¸°ë¡œ í•˜ê³  React 18ì—ì„œ ìƒˆë¡œ ì¶”ê°€ëœ APIì¸  `renderToPipeableStream` ì„ ìœ„ì£¼ë¡œ SSRë˜ëŠ” ê³¼ì •ì„ ì‚´í´ë³´ë ¤ê³  í•œë‹¤.

# renderToPipeableStreamì´ë€?

<Image src={'/ssr/ssr-blog-image-2.png'} alt={'remix-ssr-image-2'} />

React 18ì— ì¶”ê°€ëœ SSR ë©”ì„œë“œë¡œ ê¸°ì¡´ SSRì˜ ë¬¸ì œì ì¸ ëŠë¦° ì´ˆê¸° í˜ì´ì§€ ë¡œë”©ì´ë‚˜, í° HTML íŒŒì¼ ë¡œë“œì‹œ ë¸Œë¼ìš°ì €ì—ì„œì˜ í•˜ì´ë“œë ˆì´ì…˜ ë¶€í•˜ ë“±ì„ ê°œì„ í•˜ê¸° ìœ„í•´ ìƒˆë¡­ê²Œ ì†Œê°œëœ ê¸°ëŠ¥ì´ë‹¤.

[ê³µì‹ë¬¸ì„œ](https://react.dev/reference/react-dom/server/renderToPipeableStream)ì— ë”°ë¥´ë©´, ë¦¬ì•¡íŠ¸ íŠ¸ë¦¬ë¥¼ pipeable Node.js Streamìœ¼ë¡œ ë Œë”ë§í•˜ëŠ” í•¨ìˆ˜ë¼ê³  ì •ì˜ë˜ì–´ ìˆë‹¤.

## Pipeableí•œ Node.js Stream?

ì¡°ê¸ˆ ìƒì†Œí•œ ê°œë…ì´ ë‚˜ì™”ë‹¤.

[Node.jsì˜ Stream](https://nodejs.org/api/stream.html#writable-streams)ì€ ë°ì´í„°ë¥¼ ì²­í¬ ë‹¨ìœ„ë¡œ ìª¼ê°œì„œ ì½ê±°ë‚˜ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Node.js ì˜ ì¶”ìƒí™”ëœ ê°ì²´ì´ë‹¤. ëŒ€ìš©ëŸ‰ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•  ë•Œ ë§ì´ ì‚¬ìš©ëœë‹¤ê³  í•œë‹¤.

```tsx
const fs = require('fs');

const readStream = fs.createReadStream('largeFile.txt', 'utf8');

readStream.on('data', (chunk) => {
  console.log(chunk);
});
```

ì˜ˆë¥¼ ë“¤ì–´ ìœ„ì™€ ê°™ì´ Readable Streamì„ ë§Œë“¤ë©´, í° íŒŒì¼ì„ ì‘ì€ ì²­í¬ ë‹¨ìœ„ë¡œ ìª¼ê°œì„œ ì½ì–´ì˜¬ ìˆ˜ ìˆë‹¤.  ìŠ¤íŠ¸ë¦¼ ê°ì²´ì—ëŠ” ì•„ë˜ ë„¤ê°€ì§€ ì¢…ë¥˜ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

- Readable Stream (ì½ê¸° ì „ìš©)
  - ë°ì´í„°ë¥¼ ìƒì‚°í•˜ëŠ” ì†ŒìŠ¤ (ex .íŒŒì¼, HTTP ìš”ì²­, ë°ì´í„° ë² ì´ìŠ¤ ë“±)ì™€ ì—°ê²°
- Writable Stream (ì“°ê¸° ì „ìš©)
  - ë°ì´í„°ë¥¼ ëª©ì ì§€ë¡œ ì „ë‹¬ (ex. íŒŒì¼ì— ì“°ê¸°, HTTP ì‘ë‹µì— ì‚¬ìš© ë“±)
- Duplex Stream (ì½ê³ , ì“°ê¸° ì „ìš©)
  - TCP ì—°ê²°ì„ ê´€ë¦¬í•˜ëŠ” ìŠ¤íŠ¸ë¦¼ì„ ë°ì´í„°ë¥¼ ì½ê³  ì“¸ ìˆ˜ ìˆìŒ
- Transform Stream (ì½ê³  ë³€í™˜í•œ í›„ ì“°ëŠ” ìŠ¤íŠ¸ë¦¼)
  - ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ë©´ì„œ ë³€ê²½í•˜ê±°ë‚˜, ë³€í™˜í•  ìˆ˜ ìˆëŠ” ìŠ¤íŠ¸ë¦¼ (ex. ì••ì¶•, ì•”í˜¸í™”, ì¸ì½”ë”© ë³€í™˜ ë“±)

ì´ì œ ë‹¤ì‹œ Reactë¡œ ëŒì•„ì™€ì„œ,

`renderToPipeableStream` ì—ì„œëŠ” ì´ ìŠ¤íŠ¸ë¦¼ ê°ì²´ë¥¼ ì‚¬ìš©í•´ì„œ íš¨ìœ¨ì ì¸ ë°ì´í„° ì „ì†¡ê³¼ ë¹ ë¥¸ ë Œë”ë§ì„ ì§€ì›í•œë‹¤. (ì´í›„ì— ë³´ë©´ ì•Œê² ì§€ë§Œ ì»´í¬ë„ŒíŠ¸ íŒŒì¼ì„ ì½ì–´ì„œ ìŠ¤íŠ¸ë¦¼ê°ì²´ë¡œ ë§Œë“¤ê³ , HTTP ì‘ë‹µìœ¼ë¡œ ì£¼ê¸° ë•Œë¬¸ì— Readable, Writable ìŠ¤íŠ¸ë¦¼ì„ ì‚¬ìš©í•˜ê²Œ ëœë‹¤. )

ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ì´ˆê¸° í˜ì´ì§€ ë¡œë”©ì„ ì—¬ëŸ¬ ì²­í¬ë¡œ ìª¼ê°œì„œ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤. ë‹¹ì—°íˆ í•œë²ˆë‹¤ ë‹¤ ì½ê³ , ë§Œë“¤ì–´ì„œ, ë°˜í™˜í•˜ëŠ” ê²ƒë³´ë‹¤ëŠ” ì„±ëŠ¥ì´ ì¢‹ì„ ê²ƒì´ë¼ê³  ì˜ˆìƒì„ í•´ë³¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.

ì•„ë˜ëŠ” ê³µì‹ë¬¸ì„œì— ë‚˜ì˜¨ ì˜ˆì œì¸ë°, ì‰½ê²Œ ì„¤ëª…í•´ë³´ìë©´ App ì»´í¬ë„ŒíŠ¸ HTMLìœ¼ë¡œ ë Œë”ë§í•˜ê³  > ìŠ¤íŠ¸ë¦¬ë° ê°ì²´ë¡œ ë³€í™˜í•´ì„œ > í•´ë‹¹ ìŠ¤íŠ¸ë¦¬ë° ê°ì²´ë¥¼ HTTP ì‘ë‹µìœ¼ë¡œ ì „ì†¡í•˜ëŠ” ì½”ë“œë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.

í™˜ê²½ë§ˆë‹¤ ë‹¬ë¼ ì§ˆ ìˆ˜ ìˆê² ì§€ë§Œ Reactì˜ ìŠ¤íŠ¸ë¦¬ë° SSR ê¸°ëŠ¥ì„ í™œìš©í•˜ë ¤ë©´ ëŒ€ëµ ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¡œ ì‘ì„±í•˜ë©´ ëœë‹¤ê³  ê³µì‹ë¬¸ì„œì— ì í˜€ ìˆì—ˆë‹¤.

```tsx
import { renderToPipeableStream } from 'react-dom/server';

// The route handler syntax depends on your backend framework
app.use('/', (request, response) => {
  const { pipe } = renderToPipeableStream(<App />, {
    bootstrapScripts: ['/main.js'],
    onShellReady() {
      response.setHeader('content-type', 'text/html');
      pipe(response);
    }
  });
});
```

ê·¸ëŸ¼ ì´ì œ renderToPipeableStream ë©”ì†Œë“œì˜ ë™ì‘ì— ëŒ€í•´ì„œ ëŒ€ëµ ì´í•´í–ˆìœ¼ë‹ˆ, í•´ë‹¹ í•¨ìˆ˜ì˜ APIì™€ ë°˜í™˜ ê°ì²´ì— ëŒ€í•´ ê°„ë‹¨í•˜ê²Œ í•„ìš”í•œ ê²ƒë§Œ ì •ë¦¬í•´ë³´ê³ , Remixì˜ entry.server.tsx ë¡œ ë„˜ì–´ê°€ë³´ì. ğŸ¤©

```tsx
renderToPipeableStream(reactNode, options?)
```

- **Parameters**
  - `reactNode`: HTMLë¡œ ë Œë”ë§í•˜ê³  ì‹¶ì€ ë¦¬ì•¡íŠ¸ ë…¸ë“œ (ë³´í†µì€ Appê³¼ ê°™ì€ ë£¨íŠ¸ ë…¸ë“œ)
  - options
    - `bootstrapScripts(optional)` : script tagì— ì‚½ì…í•  URL ê²½ë¡œ ë°°ì—´ (í´ë¼ì´ì–¸íŠ¸ì—ì„œ hydrateRoot í˜¸ì¶œì‹œ ì‚¬ìš©)
- Returns
  - `pipe`: ì œê³µëœ HTMLì„ Writable Node.js Streamìœ¼ë¡œ ì¶œë ¥. `onShellReady` ì—ì„œ í˜¸ì¶œí•˜ë©´ ìŠ¤íŠ¸ë¦¬ë°ì„ í™œì„±í™” í•  ìˆ˜ ìˆìŒ

# Remixì—ì„œì˜ SSR

```tsx

function handleBrowserRequest(
  request: Request,
  responseStatusCode: number,
  responseHeaders: Headers,
  remixContext: EntryContext
) {
  return new Promise((resolve, reject) => {
    let shellRendered = false;
    const { pipe, abort } = renderToPipeableStream(
      <RemixServer
        context={remixContext}
        url={request.url}
        abortDelay={ABORT_DELAY}
      />,
      {
        onShellReady() {
          shellRendered = true;
          const body = new PassThrough();
          const stream = createReadableStreamFromReadable(body);

          responseHeaders.set("Content-Type", "text/html");

          resolve(
            new Response(stream, {
              headers: responseHeaders,
              status: responseStatusCode,
            })
          );

          pipe(body);
        },
        onShellError(error: unknown) {
          reject(error);
        },
        onError(error: unknown) {
          responseStatusCode = 500;
          // Log streaming rendering errors from inside the shell.  Don't log
          // errors encountered during initial shell rendering since they'll
          // reject and get logged in handleDocumentRequest.
          if (shellRendered) {
            console.error(error);
          }
        },
      }
    );

    setTimeout(abort, ABORT_DELAY);
  });
}
```

Remix(v2.15.3) ì—ì„œ Server-sideì—ì„œ ì‹¤í–‰ë˜ëŠ” `handleBrowserRequest` ì˜ ì „ì²´ ì½”ë“œì´ë‹¤.  ìì„¸í•œ íë¦„ì€ ì•„ë˜ì™€ ê°™ë‹¤.

### 1. ìŠ¤íŠ¸ë¦¬ë° ë Œë”ë§ ì„¤ì •

```tsx
const { pipe, abort } = renderToPipeableStream(
  <RemixServer context={remixContext} url={request.url} abortDelay={ABORT_DELAY} />,
  {
    // ì½œë°± í•¨ìˆ˜ë“¤
  }
);
```

ë¨¼ì € renderToPipeableStream í•¨ìˆ˜ì˜ ì²«ë²ˆì§¸ ì¸ìë¡œ RemixServer ì»´í¬ë„ŒíŠ¸ë¥¼ ë°›ì•„ ì„œë²„ì‚¬ì´ë“œ ë Œë”ë§ì„ ìœ„í•œ ì¤€ë¹„ë¥¼ í•˜ê³ (ë°ì´í„° ë¡œë“œ, ë¼ìš°íŒ… ì„¤ì • ë“±..), ìŠ¤íŠ¸ë¦¬ë°í•  HTMLì„ ë Œë”ë§í•œë‹¤.

### 2. onShellReady ì½œë°± (ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬)

```tsx
onShellReady() {
  shellRendered = true;
  const body = new PassThrough();
  const stream = createReadableStreamFromReadable(body);

  responseHeaders.set("Content-Type", "text/html");

  resolve(
    new Response(stream, {
      headers: responseHeaders,
      status: responseStatusCode,
    })
  );

  pipe(body);
```

onShellReady ì½œë°± í•¨ìˆ˜ëŠ” React HTML ë Œë”ë§ì´ ì™„ë£Œëì„ ë•Œ í˜¸ì¶œëœë‹¤. ì¦‰, React íŠ¸ë¦¬ì˜ ì´ˆê¸° ì…¸ì´ ì¤€ë¹„ëì„ ë•Œ ì‹¤í–‰ëœë‹¤.

PassThroughëŠ” Node.jsì—ì„œ ìŠ¤íŠ¸ë¦¬ë° ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ ê¸°ë³¸ ìŠ¤íŠ¸ë¦¼ í´ë˜ìŠ¤ì´ë‹¤. (ì•„ë¬´ëŸ° ë³€í˜• ì—†ì´ ì“°ê¸° ìª½ì—ì„œ ì½ê¸° ìª½ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë„˜ê¸°ëŠ” ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ íŒŒì´í”„ë¼ì¸ì„ ë§Œë“¤ë•Œ ì‚¬ìš©ë˜ëŠ” í´ë˜ìŠ¤ë¼ê³  í•œë‹¤.) PassThrough ìŠ¤íŠ¸ë¦¼ì„ HTTP ì‘ë‹µ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ReadableStream ìœ¼ë¡œ ë³€í™˜í•˜ê³ , ìµœì¢…ì ìœ¼ë¡œ HTTPì„ ë°˜í™˜í•œë‹¤.

ê·¸ë¦¬ê³  renderToPipeableStreamì—ì„œ ë°˜í™˜ëœ pipe ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ì„œ ë Œë”ë§ëœ HTMLì„ body ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ íŒŒì´í”„í•œë‹¤. ì´ ë©”ì†Œë“œ í˜¸ì¶œì´ ì‹¤ì œë¡œ ë Œë”ë§ëœ HTMLì„ í´ë¼ì´ì–¸íŠ¸ë¡œ ì ì§„ì ìœ¼ë¡œ ì „ì†¡í•˜ëŠ” ë¶€ë¶„ì´ë¼ê³  ë³¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.

### 3. onShellError

ë Œë”ë§ ì¤‘ì— ì´ˆê¸° ì…¸ ë Œë”ë§ì— ì‹¤íŒ¨í•  ê²½ìš° í˜¸ì¶œëœë‹¤. í”„ë¡œë¯¸ìŠ¤ë¥¼ rejectí•œë‹¤. (ì„œë²„ì—ì„œë§Œ ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  ë”°ë¡œ HTTPì‘ë‹µì€ ë°˜í™˜ë˜ì§€ ì•ŠëŠ”ë‹¤.)

### 4. onError

ë Œë”ë§ ì¤‘ ë°œìƒí•œ ë‹¤ë¥¸ ì¼ë°˜ì ì¸ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•œë‹¤. responseStatusCodeë¥¼ 500ìœ¼ë¡œ ì„¤ì •í•˜ê³ , ì—ëŸ¬ë¥¼ ì½˜ì†”ì— ê¸°ë¡í•œë‹¤. (ì´ˆê¸° ë Œë”ë§ì´ ì™„ë£Œëœ ì´í›„ì—)

### 5. íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬

íƒ€ì„ì•„ì›ƒì´ ë°œìƒí•˜ë©´ ë Œë”ë§ì„ ì¤‘ë‹¨í•˜ê³ , ì‘ë‹µì„ ë°˜í™˜í•œë‹¤.

# ì‹¤ì œ ìŠ¤íŠ¸ë¦¬ë°ëœ ê²°ê³¼ë¬¼

ì´ì œ Server-sideì—ì„œì˜ ìŠ¤íŠ¸ë¦¬ë° ë¹„ë°€ì„ ì•Œì•˜ìœ¼ë‹ˆ, ì‹¤ì œ ë¸Œë¼ìš°ì €ì—ì„œ ìŠ¤íŠ¸ë¦¬ë°(?)ì´ ì˜ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ì.  ê°„ë‹¨íˆ ë¹„ë™ê¸° ì»´í¬ë„ŒíŠ¸ì™€ Suspenseë¥¼ í™œìš©í•´ì„œ Streaming SSRë¥¼ Remix ì‘ì„±í•´ë´¤ë‹¤.

```tsx
import {Suspense} from "react";
import {Await} from "@remix-run/react";

const loadData = async (): Promise<{ title: string, description: string }> => {
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve({title: 'Title', description: 'Description'});
        }, 1000);
    });
}

export default function Index() {
    return (
        <>
            <div>Home</div>
            <Suspense fallback="Loading...">
                <Await resolve={loadData()}>
                    {(data) => (
                        <>
                            <h1>{data.title}</h1>
                            <span>{data.description}</span>
                        </>
                    )}
                </Await>
            </Suspense>
            <Suspense fallback="Loading...">
                <Await resolve={loadData()}>
                    {(data) => (
                        <>
                            <h1>{data.title}</h1>
                            <span>{data.description}</span>
                        </>
                    )}
                </Await>
            </Suspense>
        </>
    );
}
```

ìœ„ í˜ì´ì§€ë¡œ ì ‘ì†í–ˆì„ ë•Œ ë„¤íŠ¸ì›Œí¬ íƒ­ì—ì„œ í™•ì¸í•´ë³¸ ì‘ë‹µ í—¤ë”ì´ë‹¤.

<Image src={'/ssr/ssr-blog-image-3.png'} alt={'remix-ssr-image-3'} />

[`Transfer-Encoding: chunked` ë¼ëŠ” í—¤ë”](https://developer.mozilla.org/ko/docs/Web/HTTP/Headers/Transfer-Encoding)ê°€ ì ìš©ëœê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤(HTTP/1.1 ìŠ¤í™). HTTP ì§€ì† ì»¤ë„¥ì…˜ì—ì„œëŠ” ë³¸ë¬¸ì„ ì“°ê¸° ì „ì— ë°˜ë“œì‹œ Content-Length í—¤ë”ì— ë³¸ë¬¸ì˜ ê¸¸ì´ë¥¼ ë‹´ì•„ì„œ ë³´ë‚´ì¤˜ì•¼ í•œë‹¤. í•˜ì§€ë§Œ ì½˜í…ì¸ ê°€ ì„œë²„ì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ê²½ìš°ì—ëŠ” ë³´ë‚´ê¸° ì „ì— ë³¸ë¬¸ì˜ ê¸¸ì´ë¥¼ ì•Œì•„ë‚´ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ì²­í¬ ì¸ì½”ë”©ì€ ì„œë²„ê°€ ë³¸ë¬¸ì„ ì—¬ëŸ¬ ì²­í¬ë¡œ ìª¼ê°œ ë³´ë‚¼ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

ë¸Œë¼ìš°ì €ëŠ” ë‚¨ì€ Chunkì˜ ê¸¸ì´ê°€ 0ì´ ë ë•Œê¹Œì§€ ì»¤ë„¥ì…˜ì„ ë‹«ì§€ ì•Šê³  ê¸°ë‹¤ë¦¬ë©´ì„œ TCP/IP í•¸ë“œì…°ì´í¬ ë¹„ìš©ì„ ì ˆì•½ í•  ìˆ˜ ìˆë‹¤.

<Image src={'/ssr/ssr-blog-image-4.png'} alt={'remix-ssr-image-4'} />

ê°œë°œì ë„êµ¬ì—ì„œëŠ” ìµœì¢… ê²°ê³¼ë¬¼ë§Œ ë“¤ì–´ì˜¤ê¸° ë•Œë¬¸ì— ë°ì´í„°ê°€ ë“¤ì–´ì˜¤ëŠ” ê³¼ì •ì„ í™•ì¸í•´ë³´ë ¤ë©´ ì§ì ‘ í†µì‹ ë˜ëŠ” ë‚´ìš©ì„ ì°ì–´ë´ì•¼ ëœë‹¤ê³  í•œë‹¤. [ì´ ë¸”ë¡œê·¸](https://saengmotmi.netlify.app/react/streaming_ssr/)ë¥¼ ì°¸ê³ í•´ì„œ í™•ì¸í•´ë´¤ë‹¤.

```tsx
http.get("http://localhost:5173/", (res) => {
  res.on("data", (chunk) => {
    console.log("Received chunk: ", chunk.toString());
  });

  res.on("end", () => {
    console.log("Response finished.");
  });
}).on("error", (err) => {
  console.error("Error: ", err.message);
});'
```

<Image src={'/ssr/ssr-blog-image-5.png'} alt={'remix-ssr-image-5'} />

ì´ì œ HTTP ìŠ¤íŠ¸ë¦¬ë° í†µì‹ ì—ì„œì˜ ë¹„ë°€ë„ ì•Œê²Œ ë˜ì—ˆë‹¤..ğŸ˜‡

# ë§ˆë¬´ë¦¬

ì´ë ‡ê²Œ Remixì˜ SSRì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ë‹¤. ê·¸ë¦¬ê³  Reactì˜ renderToPipeableStream í•¨ìˆ˜ì˜ ë™ì‘ ì›ë¦¬ì™€, ê·¸ ê²°ê³¼ë¬¼ì— ëŒ€í•´ë„ ì‚´í´ë³´ë©´ì„œ ìŠ¤íŠ¸ë¦¬ë° SSRì— ëŒ€í•´ì„œë„ ê°„ëµíˆ ì •ë¦¬í•´ë´¤ë‹¤. Next.jsë³´ë‹¤ ì¶”ìƒí™”ê°€ ëœ ë˜ì–´ìˆëŠ” Remix ë•ë¶„ì— ì´ëŸ° í˜¸ê¸°ì‹¬ë„ ìƒê¸°ê³ , ë” ê°„ëµí•˜ê²Œ SSRì˜ ë™ì‘ì— ëŒ€í•´ì„œ ì‚´í´ë³¼ ìˆ˜ ìˆì—ˆë˜ê²ƒ ê°™ë‹¤.

Streaming ê¸°ë²• ë§ê³ ë„ SSRì„ ìµœì í™”í•˜ê¸° ìœ„í•œ ê¸°ë²•ë“¤ì´ ë§ì´ ì†Œê°œë˜ê³  ìˆë‹¤. ê¸°ì¡´ì— ì˜ ì•Œê³  ìˆë˜ SSG ë¶€í„°, ì„œë²„ ì»´í¬ë„ŒíŠ¸, í•˜ì´ë“œë ˆì´ì…˜ ìµœì í™” (Suspenseë¥¼ í†µí•œ ìš°ì„ ìˆœìœ„ ì¡°ì •), CDN ìºì‹± ë“±. ê° ê¸°ë²•ë“¤ì´ ì†Œê°œëì„ ë•Œ ê·¸ëŒ€ë¡œ ë°›ì•„ë“¤ì´ê¸° ë³´ë‹¤ëŠ” ì–´ë–¤ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‚˜ì˜¨ ê¸°ëŠ¥ì¸ì§€ë¥¼ ì‚´í´ë³´ê³ , ë™ì‘ì›ë¦¬ë¥¼ ì˜ ì´í•´í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤.

# ì°¸ê³ í•˜ë©´ ì¢‹ì„ ìë£Œ
- https://react.dev/reference/react-dom/server/renderToPipeableStream#rendering-a-react-tree-as-html-to-a-nodejs-stream
- https://remix.run/docs/en/main/components/await
- https://github.com/remix-run/remix/blob/main/packages/remix-react/server.tsx
- https://developer.mozilla.org/ko/docs/Web/HTTP/Headers/Transfer-Encoding
- https://saengmotmi.netlify.app/react/streaming_ssr/
